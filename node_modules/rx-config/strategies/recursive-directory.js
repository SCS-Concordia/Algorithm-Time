var fs          = require("fs");
var Rx          = require("rx");
var rxDirectory = require("rx-directory");

var readFile = Rx.Observable.fromNodeCallback(fs.readFile);

module.exports = function(path) {
    return function() {
        return rxDirectory.recursive(path).flatMap(function(file) {
            return readFile(file).map(function(contents) {
                return JSON.parse(contents);
            });
        });
    }
}
